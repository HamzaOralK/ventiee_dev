<div class="top">
  <div class="users">
    <!-- <p *ngFor="let user of activeRoom.users">{{user.nickname}}</p> -->
    <mat-list>
      <div mat-subheader>
        <div class="roomInfo" *ngIf="activeRoom">
          <span class="text">
            <b>{{'event' | ml}}:</b>&nbsp;{{activeRoom.title}}<br>
            <b>{{'time' | ml}}:</b>&nbsp;{{activeRoom.startDate | date:'dd/MM/yyyy HH:mm'}}
          </span>
          <button mat-icon-button (click)="openDialog()">
            <mat-icon>event_note</mat-icon>
          </button>
        </div>
      </div>
      <mat-list-item *ngFor="let user of activeRoom.users">
        <img mat-list-icon class="userImage" src="https://material.angular.io/assets/img/examples/shiba1.jpg">
        <div mat-line><b>{{user.nickname}}</b></div>
        <div mat-line *ngIf="isModerator()">{{'organisator' | ml}}</div>
        <button mat-icon-button [matMenuTriggerFor]="menu"><mat-icon>more_horiz</mat-icon></button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item [routerLink]="['/profile', user._id]">{{'showProfile' | ml}}</button>
          <button mat-menu-item *ngIf="isModerator() && isKickable(user)" (click)="onKickUser(user)">{{'kickUser' | ml}}</button>
        </mat-menu>
      </mat-list-item>
    </mat-list>
  </div>
  <div style="padding: 5px; width: 100%;">
    <div class="roomInfo noDesktop" *ngIf="activeRoom">
      <span class="text">
        <b>{{'event' | ml}}:</b> {{activeRoom.title}}&nbsp; / {{activeRoom.startDate | date:'dd/MM/yyyy HH:mm'}}
      </span>
      <button mat-icon-button (click)="openDialog()">
        <mat-icon>event_note</mat-icon>
      </button>
    </div>
    <div #messages class="messages scroll">
      <div class="inner" *ngIf="activeRoom">
        <div #messagesContainer class="all" [ngClass]="isOwn(message) ? 'own' : 'other' " *ngFor="let message of activeRoom.messages; let i = index;">
          <div style="max-width: 65%; overflow: hidden;">
            <span
              *ngIf="i > 0 && activeRoom.messages[i-1].user._id !== message.user._id && !isOwn(message)">{{message.user.nickname}}</span>
            <span *ngIf="i === 0 && !isOwn(message)">{{message.user.nickname}}</span>
            <div class="message">
              <span class="messageText">{{message.message}}</span><br>
              <span class="messageDate">{{message.date | date:'dd/MM/yyyy HH:mm'}}</span>

            </div>
          </div>
        </div>
      </div>
    </div>
    <form (submit)="submit($event)" (keyup.enter)="sendMessage($event)" (keydown.enter)="$event.preventDefault()">
      <mat-form-field appearance="outline" class="messageEntry">
        <mat-label>Bir şey yazın.</mat-label>
        <textarea matInput (focus)="textareaFocus()" style="resize: none"></textarea>
      </mat-form-field>
      <!-- <emoji-mart class="emojis" set="apple" [showPreview]="false"></emoji-mart> -->
    </form>
  </div>
</div>
